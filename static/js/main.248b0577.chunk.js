(this["webpackJsonp@set/mobile"]=this["webpackJsonp@set/mobile"]||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t),n.d(t,"postActionsMiddleware",(function(){return Ke}));var c=n(8),r=n(22),i=n(11),a=n(37),o=n(25),s=n(19),u=n(0),l=Object(u.g)(i.g([Object(u.k)(a.a,s.a((function(e){return e.id})))]),i.d,o.b((function(e){return e.id})),o.a((function(){return 0}),u.j)),d=function(e,t){return Object(u.k)(e,i.b((function(e){return e.id!==t})))},j=n(20),m=Object(j.b)({name:"timeStamps",initialState:[],reducers:{add:function(e,t){return n=e,r=t.payload,Object(u.k)(n,i.a(Object(c.a)(Object(c.a)({},r),{},{id:l(n)})));var n,r},assignPlayer:function(e,t){return n=e,r=t.payload,Object(u.k)(n,i.f(Object(u.k)(n,i.c((function(e){return e.id===r.id})),o.a((function(){return-1}),(function(e){return e}))),(function(e){return Object(c.a)(Object(c.a)({},e),r)})),o.a((function(){return n}),(function(e){return e})));var n,r},reset:function(e,t){return n=e,c=t.payload.id,d(n,c);var n,c}}}),b=m.actions,f=b.add,h=b.reset,x=b.assignPlayer,p=m.reducer,O=n(13),g=n.n(O),v=n(38),y=n(9),N=n(7),w=n(1),k=function(e){var t=e.text,n=e.path,c=e.icon,r=n===e.chosenPath?"opacity-100":"opacity-20";return Object(w.jsxs)(v.b,{to:"".concat("/timer","/").concat(n),className:"".concat(r," transition-opacity w-12 flex flex-col items-center px-4 py-2"),children:[Object(w.jsx)(O.Icon,{color:"white",size:1,path:c}),Object(w.jsx)("p",{className:"text-xs text-white font-semibold",children:t})]})},I=function(){var e=Object(y.g)().pathname.split("/timer")[1].slice(1);return Object(w.jsxs)("div",{className:"flex justify-around text-black",children:[Object(w.jsx)(k,{path:"config",text:"Config",icon:N.h,chosenPath:e}),Object(w.jsx)(k,{path:"list",text:"Players",icon:N.l,chosenPath:e}),Object(w.jsx)(k,{path:"pad",text:"Pad",icon:N.j,chosenPath:e}),Object(w.jsx)(k,{path:"times",text:"Times",icon:N.p,chosenPath:e})]})},C=n(2),S=n.n(C),E=Object(C.createContext)({timeKeeperId:void 0,setTimeKeeperId:function(){}}),K=function(e){switch(e){case"start":return N.n;case"checkpoint":return N.o;case"end":return N.k;default:throw new Error("Not handled time keeper type")}},P=function(e){var t=e.type;return Object(w.jsx)(O.Icon,{size:1,path:K(t)})},T=n(33),D=function(){return Object(T.b)()},_=T.c,z=function(){var e=_((function(e){return e.timeKeepers}));return Object(w.jsx)(E.Consumer,{children:function(t){var n=t.setTimeKeeperId;return Object(w.jsx)("div",{className:"flex h-full w-full justify-center items-start bg-gray-800 pl-20 flex-col",children:e.map((function(e){return Object(w.jsxs)("button",{onClick:function(){return n(e.id)},className:"flex items-center py-4 px-4 my-2",children:[Object(w.jsx)(P,{type:e.type}),Object(w.jsx)("span",{className:"ml-4 text-xl",children:e.name})]},e.id)}))})}})},A={addDigit:function(e){return function(t){return t.concat(e)}},back:function(e){return e.slice(0,-1)},reset:function(e){return""}},F=[{char:"1",changeNumber:A.addDigit("1")},{char:"2",changeNumber:A.addDigit("2")},{char:"3",changeNumber:A.addDigit("3")},{char:"4",changeNumber:A.addDigit("4")},{char:"5",changeNumber:A.addDigit("5")},{char:"6",changeNumber:A.addDigit("6")},{char:"7",changeNumber:A.addDigit("7")},{char:"8",changeNumber:A.addDigit("8")},{char:"9",changeNumber:A.addDigit("9")},{char:"\u21ba",changeNumber:A.reset,alwaysEnabled:!0},{char:"0",changeNumber:A.addDigit("0")},{char:"\u2190",changeNumber:A.back,alwaysEnabled:!0}],L=function(e){var t=e.char,n=e.padClick,c=e.enabled,r=e.alwaysEnabled;return Object(w.jsx)("button",{onClick:n,disabled:!r&&!c,className:"disabled:opacity-20 text-2xl transition-opacity rounded-md text-white m-1.5 ",children:t})},R=function(e){return Object(w.jsx)("div",{className:"grid h-2/5 self-center w-5/6 grid-cols-3 py-2 grid-rows-4",children:F.map((function(t){return Object(w.jsx)(L,{alwaysEnabled:t.alwaysEnabled,enabled:e.availableDigits.includes(t.char),padClick:function(){return function(t){var n=t.changeNumber(e.number);e.onNumberChange(n)}(t)},char:t.char},t.char)}))})},M=n(34),B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString("en-US",{minimumIntegerDigits:t})},W=function(e){return"".concat(B(e.getHours()),":").concat(B(e.getMinutes()),":").concat(B(e.getSeconds()),".").concat(B(e.getMilliseconds(),3).slice(0,1))},J=function(e,t){return Object(u.k)(t,i.e(String),i.b(M.b(e)),i.e((function(t){return M.a(e.length,t.length)(t)})),i.e(M.a(0,1)),i.b((function(e){return!!e})))},q=function(e){var t=e.playerNumber;return Object(w.jsx)("div",{className:"text-orange-500 h-16 flex text-center justify-center text-4xl font-regular py-2",children:t})},G=function(e){var t=e.player,n=e.onPlayerCheckIn;return Object(w.jsxs)("button",{onClick:function(){return n(t.id)},className:"bg-gradient-to-r from-orange-500 to-red-500 mt-2 flex w-full px-4 py-2 items-center shadow-md rounded-md",children:[Object(w.jsx)("div",{className:"font-bold text-2xl mr-4",children:t.number}),Object(w.jsxs)("div",{children:[t.name," ",t.lastName]})]})},H=function(e){var t,n,a=e.onPlayerCheckIn,o=e.title,s=e.timeKeeperId,l=Object(C.useState)(""),d=Object(r.a)(l,2),j=d[0],m=d[1],b=_((function(e){return e.players})),f=_((function(e){return e.timeStamps})),h=b.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{timeStamp:f.find((function(t){return t.playerId===e.id&&t.timeKeeperId===s}))})})).filter((function(e){return void 0===e.timeStamp})),x=h.map((function(e){return e.number})),p=(n=x,""!==(t=j)?Object(u.k)(n,i.b(Object(u.g)(String,M.b(t)))):[]),O=h.filter((function(e){return p.includes(e.number)}));return Object(w.jsxs)("div",{className:"flex h-full flex-col",children:[o&&Object(w.jsx)("h1",{className:"text-2xl text-center py-4",children:o}),Object(w.jsx)("div",{className:"flex-auto flex flex-col-reverse mx-12 overflow-y-auto mt-2 items-stretch h-3/5",children:O.map((function(e){return Object(w.jsx)(G,{onPlayerCheckIn:function(e){a(e),m("")},player:e},e.id)}))}),Object(w.jsx)(q,{playerNumber:j}),Object(w.jsx)(R,{availableDigits:J(j,x),number:j,onNumberChange:m})]})},U=function(e){var t=e.playerWithTimeStamp;return Object(w.jsxs)("span",{className:"flex flex-grow h-12",children:[Object(w.jsx)("span",{className:"text-3xl mr-4",children:t.number?B(t.number,3):"- - -"}),Object(w.jsxs)("span",{className:"flex-grow",children:[Object(w.jsx)("div",{className:"text-lg font-semibold ",children:Object(w.jsx)("span",{children:t.timeStamp?W(new Date(t.timeStamp.time)):"- - - - - - -"})}),Object(w.jsxs)("div",{className:"opacity-50 text-sm",children:[t.name," ",t.lastName]})]})]})},Q=function(e){var t=e.onClick,n=e.icon;return Object(w.jsx)("button",{onClick:t,className:"w-10 bg-gradient-to-r from-orange-500 to-red-500 flex items-center rounded-md px-2 py-1 self-center text-white",children:Object(w.jsx)(g.a,{path:n,size:1,color:"white"})})},V=function(e){var t=e.onClick,n=e.icon,c=e.contents;return Object(w.jsxs)("button",{onClick:t,className:"w-10 bg-gray-600 flex items-center rounded-md px-2 py-1 self-center text-white",children:[n&&Object(w.jsx)(g.a,{path:n,size:1,color:"white"}),c]})},X=function(e){var t=e.players,n=e.onTimeRecord,c=e.onTimeReset,r=function(e){return function(){return n(e)}};return Object(w.jsx)("div",{className:"px-4 text-white",children:t.map((function(e){return Object(w.jsxs)("div",{className:"py-5 flex items-center",children:[Object(w.jsx)(U,{playerWithTimeStamp:e}),e.timeStamp?Object(w.jsx)(Q,{icon:N.d,onClick:(t=e.timeStamp.id,function(){return c(t)})}):Object(w.jsx)(Q,{icon:N.c,onClick:r(e.id)}),e.timeStamp&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("span",{className:"ml-1 bg-gray-600 flex items-center rounded-md px-2 py-1 text-white",children:Object(w.jsx)(g.a,{path:N.r,size:1,color:"white"})}),Object(w.jsx)("span",{className:"ml-1 bg-gray-600 flex items-center rounded-md px-2 py-1 text-white",children:Object(w.jsx)(g.a,{path:N.b,size:1,color:"white"})})]})]},e.number);var t}))})},Y=n(45),Z=n(44),$=n.n(Z),ee=function(e){return Object(Y.a)(e).sort((function(e,t){return t.time-e.time}))},te=function(e){var t=e.times,n=e.onAddTime,c=Object(C.useState)(),i=Object(r.a)(c,2),a=i[0],o=i[1],s=$()({bindTo:document.getElementById("module-holder")}).Portal,u=D();return Object(w.jsxs)("div",{className:"px-4",children:[void 0!==a&&Object(w.jsx)(s,{children:Object(w.jsx)("div",{className:"absolute inset-0 h-full w-full bg-gray-800",children:Object(w.jsx)(H,{onPlayerCheckIn:function(e){u(x({playerId:e,id:a})),o(void 0)},title:"Assign time to player"})})}),Object(w.jsx)("div",{className:"flex flex-col mt-2",children:Object(w.jsx)("button",{onClick:n,className:"self-end rounded-md text-center bg-gradient-to-r w-20 flex justify-center from-orange-500 to-red-500 py-2 px-4",children:Object(w.jsx)(O.Icon,{color:"white",size:1,path:N.m})})}),ee(t).map((function(e){var t,n,c;return Object(w.jsxs)("div",{className:"flex py-5 items-center",children:[Object(w.jsx)(U,{playerWithTimeStamp:{timeStamp:e,number:null===(t=e.player)||void 0===t?void 0:t.number,name:null===(n=e.player)||void 0===n?void 0:n.name,lastName:null===(c=e.player)||void 0===c?void 0:c.lastName}}),!e.player&&Object(w.jsx)(Q,{onClick:function(){return o(e.id)},icon:N.a}),Object(w.jsx)("span",{className:"ml-1",children:Object(w.jsx)(V,{icon:N.i,onClick:function(){u(h({id:e.id}))}})})]},e.id)}))]})},ne=n(56)("wss://wss.set-hub.pyszstudio.pl",{transports:["websocket"]}),ce=[],re=function(e){return ce.forEach((function(t){return t(e)}))};ne.on("connect",(function(){re("connected")})),ne.on("disconnect",(function(e){re("disconnected")})),ne.on("connect_failed",(function(){re("disconnected")})),ne.io.on("error",(function(){re("error")})),ne.io.on("reconnect",(function(e){re("connected")})),ne.io.on("reconnect_error",(function(e){re("reconnecting")})),ne.io.on("reconnect_attempt",(function(e){re("reconnecting")})),ne.io.on("reconnect_failed",(function(){re("disconnected")}));var ie=Object(C.createContext)({offset:0}),ae=function(e){var t=e.time;return Object(w.jsx)("div",{className:"w-24 text-xl",children:W(new Date(t))})},oe=function(e){var t=e.offset,n=Object(C.useState)(Date.now()+t),c=Object(r.a)(n,2),i=c[0],a=c[1];return Object(C.useEffect)((function(){var e=setInterval((function(){return a(Date.now()+t)}),10);return function(){return clearInterval(e)}}),[t]),Object(w.jsx)(ae,{time:i})},se=function(e){switch(e){case"connected":return N.f;case"disconnected":return N.e;case"error":return N.q;case"reconnecting":return N.g;default:throw new Error("not handled connection state")}},ue=function(e){switch(e){case"connected":return"ON-LINE";case"disconnected":case"error":return"OFF-LINE";case"reconnecting":return"CONNECTING";default:throw new Error("not handled connection state")}},le=function(e){var t=e.timeKeeperName,n=Object(C.useState)("disconnected"),c=Object(r.a)(n,2),i=c[0],a=c[1],o=_((function(e){return e.timeKeepers}));return Object(C.useEffect)((function(){var e,t=(e=a,ce.push(e),function(){ce.splice(ce.indexOf(e),1)});return function(){return t()}}),[]),Object(w.jsx)(ie.Consumer,{children:function(e){var n=e.offset;return Object(w.jsx)(E.Consumer,{children:function(e){var c=e.timeKeeperId;return Object(w.jsxs)("div",{className:"px-5 w-screen flex-shrink-0 flex items-center justify-between bg-gradient-to-r from-orange-500 to-red-500 font-semibold h-10",children:[Object(w.jsxs)("span",{className:"flex",children:[void 0!==c&&Object(w.jsx)(P,{type:o.find((function(e){return e.id===c})).type}),Object(w.jsx)("span",{children:null!==t&&void 0!==t?t:"NO_TIMEKEPER"})]}),Object(w.jsx)(oe,{offset:n}),Object(w.jsxs)("span",{className:"text-xs flex items-center",children:[Object(w.jsx)("span",{className:"mr-2",children:ue(i)}),Object(w.jsx)(O.Icon,{path:se(i),size:1})]})]})}})}})},de=function(e){return Date.now()+e};var je=function(){var e,t=_((function(e){return e.players})),n=_((function(e){return e.timeStamps})),i=Object(C.useState)(),a=Object(r.a)(i,2),o=a[0],s=a[1],u=_((function(e){return e.timeKeepers})),l=D(),d=function(e){return t.map((function(t){return Object(c.a)(Object(c.a)({},t),{},{timeStamp:n.find((function(n){return n.playerId===t.id&&n.timeKeeperId===e}))})}))},j=function(e){return n.filter((function(t){return t.timeKeeperId===e})).map((function(e){return Object(c.a)(Object(c.a)({},e),{},{player:t.find((function(t){return e.playerId===t.id}))})}))};return Object(w.jsx)(E.Provider,{value:{timeKeeperId:o,setTimeKeeperId:s},children:Object(w.jsx)(v.a,{children:Object(w.jsxs)("div",{id:"app-holder",className:"flex flex-col overflow-hidden bg-gray-800 h-full w-screen text-white",children:[Object(w.jsx)(le,{timeKeeperName:null===(e=u.find((function(e){return e.id===o})))||void 0===e?void 0:e.name}),Object(w.jsx)("div",{id:"module-holder",className:"relative overflow-hidden flex-col flex-1",children:Object(w.jsx)("div",{className:"h-full flex-1 overflow-y-scroll",children:Object(w.jsx)(ie.Consumer,{children:function(e){var t=e.offset;return Object(w.jsx)(E.Consumer,{children:function(e){var n=e.timeKeeperId;return Object(w.jsxs)(y.d,{children:[Object(w.jsx)(y.b,{exact:!0,path:"".concat("/timer","/"),children:Object(w.jsx)(y.a,{to:"".concat("/timer","/config")})}),Object(w.jsx)(y.b,{exact:!0,path:"".concat("/timer","/config"),children:Object(w.jsx)(z,{})}),void 0!==n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(y.b,{exact:!0,path:"".concat("/timer","/list"),children:Object(w.jsx)(X,{onTimeRecord:function(e){return l(f({playerId:e,timeKeeperId:n,time:de(t)}))},onTimeReset:function(e){return l(h({id:e}))},players:d(n)})}),Object(w.jsx)(y.b,{exact:!0,path:"".concat("/timer","/pad"),children:Object(w.jsx)(H,{onPlayerCheckIn:function(e){l(f({playerId:e,timeKeeperId:n,time:de(t)}))},title:"Clock in player",timeKeeperId:o})}),Object(w.jsx)(y.b,{exact:!0,path:"".concat("/timer","/times"),children:Object(w.jsx)(te,{onAddTime:function(){l(f({timeKeeperId:n,time:de(t)}))},times:j(n)})})]})]})}})}})})}),Object(w.jsx)("div",{children:Object(w.jsx)(I,{})})]})})})},me=n(30),be=n.n(me),fe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,64)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),i(e),a(e)}))},he=Object(j.b)({name:"players",initialState:[],reducers:{register:function(e,t){return n=e,r=t.payload,Object(u.k)(n,i.a(Object(c.a)(Object(c.a)({},r),{},{id:l(n)})));var n,r},changeInfo:function(e,t){return n=e,c=t.payload,Object(u.k)(n,i.h(Object(u.k)(n,i.c((function(e){return e.id===c.id})),o.a((function(){return-1}),(function(e){return e}))),c),o.a((function(){return n}),(function(e){return e})));var n,c}}}),xe=he.actions,pe=(xe.register,xe.changeInfo,he.reducer),Oe=Object(j.b)({name:"raceCategories",initialState:[],reducers:{add:function(e,t){return n=e,r=t.payload,Object(u.k)(n,i.a(Object(c.a)(Object(c.a)({},r),{},{id:l(n)})));var n,r},remove:function(e,t){return n=e,c=t.payload.id,d(n,c);var n,c}}}),ge=Oe.actions,ve=(ge.add,ge.remove,Oe.reducer),ye=Object(j.b)({name:"timeKeepers",initialState:[],reducers:{add:function(e,t){return n=e,r=t.payload,Object(u.k)(n,i.a(Object(c.a)(Object(c.a)({},r),{},{id:l(n)})));var n,r},remove:function(e,t){return n=e,c=t.payload.id,d(n,c);var n,c}}}),Ne=ye.actions,we=(Ne.add,Ne.remove,ye.reducer),ke=n(23),Ie=Object(ke.b)({players:pe,timeKeepers:we,timeStamps:p,raceCategories:ve}),Ce=function(e,t){return"REPLACE_STATE"===t.type?t.state:Ie(e,t)},Se=(Object(j.a)({reducer:Ie}),n(62),0);ne.on("receive-action",(function(e){return Pe.dispatch(Object(c.a)(Object(c.a)({},e),{},{__remote:!0}))})),ne.on("receive-state",(function(e){return Pe.dispatch({type:"REPLACE_STATE",state:e,__remote:!0})})),ne.on("sync-time",(function(e){Se=Date.now()-e,console.log("timeOffset: ",Se,"ms")}));var Ee,Ke=function(e){return function(e){return function(t){!t.__remote&&ne.connected&&ne.emit("post-action",t),e(t)}}},Pe=(Ee=[Ke],Object(j.a)({reducer:Ce,middleware:function(e){return e().concat(Ee)}}));be.a.render(Object(w.jsx)(S.a.StrictMode,{children:Object(w.jsx)(T.a,{store:Pe,children:Object(w.jsx)(ie.Provider,{value:{offset:Se},children:Object(w.jsx)(je,{})})})}),document.getElementById("root")),fe()}},[[63,1,2]]]);
//# sourceMappingURL=main.248b0577.chunk.js.map